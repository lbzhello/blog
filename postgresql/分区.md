# 表分区

## 创建分区表
PG支持非常灵活的分区布局，看本文提到的HASH分区拆分，支持任意层级的分区，支持每个分区的层级深度不一样。特别适合某些数据分布不均匀的情况。

PostgreSQL提供了一种方法指定如何把一个表划分成称为分区的片段。被划分的表被称作分区表。这种说明由分区方法以及要被用作分区键的列或者表达式列表组成。

所有被插入到分区表的行将被基于分区键的值路由到分区中。每个分区都有一个由其分区边界定义的数据子集。当前支持的分区方法是范围、列表以及哈希。

## RANGE
```sql
-- 创建 range 分区表
CREATE TABLE measurement (
    city_id         int not null,
    logdate         date not null,
    peaktemp        int,
    unitsales       int
) PARTITION BY RANGE (logdate);

-- 创建分区, 左闭右开
CREATE TABLE measurement_y2006m02 PARTITION OF measurement
    FOR VALUES FROM ('2006-02-01') TO ('2006-03-01');

-- 创建分区的分区
CREATE TABLE measurement_y2006m02 PARTITION OF measurement
    FOR VALUES FROM ('2006-02-01') TO ('2006-03-01')
    PARTITION BY RANGE (peaktemp);
```

## HASH
```sql
-- 创建 hash 分区表
create table t_hash (
    id int, 
    info text
) PARTITION BY HASH (id);

-- 创建子分区; 表示满足条件 id/4 余 0
CREATE TABLE t_hash0 PARTITION OF t_hash 
    FOR VALUES WITH (MODULUS 4, REMAINDER 0);

CREATE TABLE t_hash1 PARTITION OF t_hash 
    FOR VALUES WITH (MODULUS 4, REMAINDER 1);
```

## LIST
```sql

```

参考：
[表分区](http://www.postgres.cn/docs/13/ddl-partitioning.html)